<!--
    
    JWT Authentication Extension Schema
    
    ** Please DO NOT edit this file yourself. **
    
    If you want to add configuration sections to the schema, you may place 
    them in .xml files similar to this one, in this directory. They will be 
    picked up automatically on startup.
-->

<configSchema>
  <sectionSchema name="system.webServer/security/authentication/jwtAuthentication">
    <attribute name="enabled" type="bool" defaultValue="false" />
    <attribute name="validationType" type="enum" defaultValue="Header">
      <enum name="Header" value="0" />
      <enum name="Cookie" value="1" />
      <enum name="Url" value="2" />
    </attribute>
    <attribute name="path" type="string" />
    <attribute name="algorithm" type="enum" defaultValue="HS256">
      <enum name="HS256" value="0" />
      <enum name="RS256" value="1" />
    </attribute>
    <attribute name="key" type="string" />
    <attribute name="keySource" type="string" />
    <attribute name="nameGrant" type="string" defaultValue="sub" />
    <attribute name="roleGrant" type="string" defaultValue="role" />
    <element name="policies">
      <collection addElement="add" clearElement="clear" removeElement="remove">
        <attribute name="accessType" type="enum" required="true">
          <enum name="Allow" value="0" />
          <enum name="Deny" value="1" />
        </attribute>
        <attribute name="users" type="string" isCombinedKey="true" validationType="nonEmptyString"  />
        <attribute name="roles" type="string" isCombinedKey="true" validationType="nonEmptyString"  />
        <attribute name="verbs" type="string" caseSensitive="true" isCombinedKey="true" validationType="nonEmptyString"  />
      </collection>
    </element>
    <element name="grantHeaderMappings">
      <collection addElement="add" clearElement="clear" removeElement="remove">
        <attribute name="grant" type="string" isCombinedKey="true" validationType="nonEmptyString" />
        <attribute name="header" type="string" isCombinedKey="true" validationType="nonEmptyString" />
        <attribute name="replace" type="bool" defaultValue="true" />
      </collection>
    </element>
  </sectionSchema>
</configSchema>